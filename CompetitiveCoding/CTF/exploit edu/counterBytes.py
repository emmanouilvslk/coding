#!/usr/bin/python3

import sys
from pwn import *

# Set context for binary
context(os="linux", arch="amd64", log_level="error")

# Load the ELF file
file = ELF(sys.argv[1])

# Retrieve the .text section
shellcode = file.section(".text")

# Count the bytes
byte_count = len(shellcode)

# Print the shellcode in hexadecimal format and byte count
print(shellcode.hex())
print(f"{byte_count} bytes")

# Check for NULL bytes and print the result
if any(byte == 0 for byte in shellcode):
    print("Found NULL byte")
else:
    print("No NULL bytes")
